<md-toolbar class="md-hue-3">
  <h2 class="md-toolbar-tools">
    <span>Create New Recipe</span>
  </h2>
</md-toolbar>
<md-content class="md-padding" ng-controller="RecipeCreateController as ctrl">
  <form name="recipeForm" ng-submit="ctrl.createRecipe()">
    <md-input-container flex>
      <label>Name</label>
      <input type="text" ng-model="recipe.name" required placeholder="Recipe name, e.g. Pasta carbonara">
    </md-input-container>
    <h4>Ingredients</h4>
    <md-autocomplete
      md-delay="300"
      md-selected-item="ctrl.selectedItem"
      md-selected-item-change="ctrl.addIngredient(item)"
      md-search-text="ctrl.searchText"
      md-items="item in ctrl.querySearch(ctrl.searchText)"
      md-item-text="item.name"
      placeholder="Type in the name of ingredient you want to add to this recipe">
      <span md-highlight-text="ctrl.searchText">{{item.name}}</span>
    </md-autocomplete>
    <md-list>
      <md-item ng-repeat="ingredient in ctrl.ingredients track by ingredient.name">
        <md-item-content>
          <div class="md-tile-left">
            <img ng-src="images/ingredient-icon.png" class="face">
          </div>
          <div class="md-tile-content" layout="row" layout-align="space-between">
            <div>
              <h3>{{ingredient.name}}</h3>

              <p>
                Calories: {{ingredient.nutrients.energy.value}}{{ingredient.nutrients.energy.unit}}<br/>
                Fat: {{ingredient.nutrients.fat.value}}{{ingredient.nutrients.fat.unit}}
                Protein: {{ingredient.nutrients.protein.value}}{{ingredient.nutrients.protein.unit}}
                Carbohydrate: {{ingredient.nutrients.carbohydrate.value}}{{ingredient.nutrients.carbohydrate.unit}}
              </p>
            </div>
          </div>
        </md-item-content>
        <md-divider ng-if="!$last"></md-divider>
      </md-item>
    </md-list>

    <md-input-container flex>
      <label>Time to cook</label>
      <input type="number" ng-model="recipe.timeToCook" required placeholder="Time to prepare this dish in minutes">
    </md-input-container>
    <md-input-container flex>
      <label>Cooking directions</label>
      <textarea ng-model="recipe.directions" columns="1" rows="6"></textarea>
    </md-input-container>

    <div layout="row" layout-align="space-between">
      <md-progress-linear md-mode="indeterminate" ng-show="ctrl.isLoading"></md-progress-linear>
      <md-button formnovalidate class="md-button-wide" ng-hide="ctrl.isLoading" ng-click="go('recipesList', 'slide-up');">
        go back
      </md-button>
      <md-button class="md-raised md-primary md-button-wide" ng-hide="ctrl.isLoading">
        create
      </md-button>
    </div>
  </form>
</md-content>
